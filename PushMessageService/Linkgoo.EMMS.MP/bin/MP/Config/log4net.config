<?xml version="1.0"?>
<log4net xsi:noNamespaceSchemaLocation="http://csharptest.net/downloads/schema/log4net.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <!--定义日志的输出媒介，下面定义日志以四种方式输出。也可以下面的按照一种类型或其他类型输出。-->
  <root>
    <level value="ALL" />
    <appender-ref ref="LogFileAppender" />
    <!--<appender-ref ref="ConsoleAppender" />            <appender-ref ref="EventLogAppender" />            <appender-ref ref="RollingLogFileAppender" />-->
  </root>
  <logger name="EMMS_ServiceLog" additivity="false">
  <level value="ALL" />
    <appender-ref ref="RollingLogFileAppender" />
    <appender-ref ref="ADONetAppender" />
  </logger>
  <logger name="SystemLog" additivity="false">
    <level value="ALL" />
    <appender-ref ref="RollingLogFileAppender" />
    <appender-ref ref="ADONetAppender" />
  </logger>
  <!--定义输出到控制台命令行中-->
  <appender name="ConsoleAppender" type="log4net.Appender.ConsoleAppender">
    <layout type="log4net.Layout.PatternLayout">
      <!--conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline" /-->
      <conversionPattern value="时间:%date [线程:%thread] %-5level  [类:%c][%L行]%n    %-5level:%message%newline" />
    </layout>
  </appender>
  <!--定义输出到windows事件中-->
  <appender name="EventLogAppender" type="log4net.Appender.EventLogAppender">
    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline" />
    </layout>
  </appender>
  <!--RollingFileAppender是输出源也是输出到文件中，只是以自增长的方式-->
  <appender name="RollingLogFileAppender" type="log4net.Appender.RollingFileAppender">
    <param name="Encoding" value="utf-8" />
    <!--日志记录级别
    <filter type="log4net.Filter.LevelRangeFilter">
      <param name="LevelMin" value="ERROR" />
      <param name="LevelMax" value="ERROR" />
    </filter>-->
    <param name="Encoding" value="utf-8" />
    <param name="File" value="log/pushmsg_log_"/>
    <!--是否覆盖-->
    <param name="AppendToFile" value="true"/>
    <!--设置无限备份=-1 ，最大备份数为1000-->
    <param name="MaxSizeRollBackups" value="100"/>
    <!--每个文件的最大20k-->
    <param name="MaximumFileSize" value="1KB"/>
    <!--名称是否可以更改 为false为可以更改-->
    <param name="StaticLogFileName" value="false"/>
    <!--文件名称-->
    <param name="DatePattern" value="yyyy年MM月dd日HH时&quot;.log&quot;"/>
    <param name="RollingStyle" value="Date"/>
    <layout type="log4net.Layout.PatternLayout">
      <!--conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] - %SysMessage%newline" /-->
      <conversionPattern value="[%sVersion]:时间:%date [线程:%thread] %-5level  [类:%c][%L行]%n    %-5level:%message%newline" />
    </layout>
    <parameter>
      <parameterName value="@sVersion"/>
      <dbType value="String" />
      <size value="255" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%property{sVersion}" />
      </layout>
    </parameter>
  </appender>

  <appender name="ADONetAppender" type="log4net.Appender.ADONetAppender">
    <bufferSize value="10" />
    <connectionType value="System.Data.SqlClient.SqlConnection, System.Data, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
    <connectionString value="Server=t9q8nuvccv.database.chinacloudapi.cn; Database=127.0.0.1; user id=sa; password=sa;Connection Timeout=300;" />
    <commandText value="INSERT INTO MessagePushLog ([dtDate],[sThread],[sLevel],[sLogger],[sMessage],[sException],[Version]) 
                 VALUES (@log_date, @thread, @log_level, @logger, @message, @exception,@sVersion)" />
    <parameter>
      <parameterName value="@log_date" />
      <dbType value="DateTime" />
      <layout type="log4net.Layout.RawTimeStampLayout" />
    </parameter>
    <parameter>
      <parameterName value="@thread" />
      <dbType value="String" />
      <size value="100" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%t" />
      </layout>
    </parameter>
    <parameter>
      <parameterName value="@log_level" />
      <dbType value="String" />
      <size value="200" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%p" />
      </layout>
    </parameter>
    <parameter>
      <parameterName value="@logger" />
      <dbType value="String" />
      <size value="500" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%logger" />
      </layout>
    </parameter>
    <parameter>
      <parameterName value="@message" />
      <dbType value="String" />
      <size value="3000" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%m" />
      </layout>
    </parameter>
    <parameter>
      <parameterName value="@exception" />
      <dbType value="String" />
      <size value="4000" />
      <layout type="log4net.Layout.ExceptionLayout" />
    </parameter>
    <parameter>
      <parameterName value="@sVersion"/>
      <dbType value="String" />
      <size value="255" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%property{sVersion}" />
      </layout>
    </parameter>
    <filter type="log4net.Filter.LevelRangeFilter">
      <param name="LevelMin" value="ERROR" />
      <param name="LevelMax" value="ERROR" />
    </filter>
  </appender>
</log4net>